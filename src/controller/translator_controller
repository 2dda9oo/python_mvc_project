import os
from model.translator import Translator

class TranslatorController:
    def __init__(self, di_path="dictionary.xlsx", xml_path="strings.xml", base_dir="output"):
        # Translator 인스턴스 초기화
        self.translator = Translator(di_path, xml_path, base_dir)

    def translate(self, input_file):
        # 입력 파일 경로가 존재하는지 확인
        if not os.path.isfile(input_file):
            print(f"Input file '{input_file}' does not exist.")
            return
        
        print(f"Translating file: {input_file}")
        self.translator.translate_xml(input_file)
        print("Translation completed.")

if __name__ == "__main__":
    # 사용자 입력 처리
    input_file = input("Enter the path to the XML file you want to translate: ")
    controller = TranslatorController()
    controller.translate(input_file)